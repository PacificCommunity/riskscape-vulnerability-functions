import numpy as np

# Calculate crop loss
def function(crops, hazard):
	
	# Flood depths for depth-damage curve interpolation.
    depth_x = [0.0, 0.25, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.1, 10.0]

    # Damage ratios for point infrastructure classes. Add new array for each new crop class. 
    CR1_ydr = [0.0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.65, 1.0]# Class 1 i.e., Tree Crop 
    CR2_ydr = [0.0, 0.025, 0.5, 1, 1, 1, 1, 1, 1, 1.0]# Class 2 i.e., Annual, root and other crops
	
	# Set default flood depths
    if hazard is None:
        depth = 0
    else:
        depth = hazard
		
	# Define infrastructure point use from exposure layer.
    useCR = crops["UseType"]
#    subuseCR = crops["SubUseType"]
    valueCR = crops["Value"]

    if depth is None:
        return {'Direct_Loss': 0}
    else:
        if useCR  == 'Tree Crop':
            damage_ratio = np.interp(depth, depth_x, CR1_ydr)
        else:
            damage_ratio = np.interp(depth, depth_x, CR2_ydr)

        loss = int(damage_ratio * valueCR)
        return {'Direct_Loss': loss}
